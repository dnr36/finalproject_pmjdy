---
title: "Data Science for Public Policy"
subtitle: "Final Project: Predicting the PMJDY Takeup Rate in India"
author: "Meenakshi Alagusundaram - ma2309, Sanya Bahal - sb2063, Diana Rivas - dnr36, Sona Sarin - srs368"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

## 

# Data Wrangling and Exploratory Data Analysis

### Loading Libraries

```{r Libraries }
library(tidyverse)
library(haven)
library(dplyr)
library(ggplot2)
library(tidymodels)
library(readr)  
library(ranger)
library(sf)
library(rgeoboundaries)
library(ggthemes)
library(rlang)
library(expss)
library(patchwork)
library(rsample)
library(tidyclust)
library(factoextra)
library(broom)
library(yardstick)
library(vip)
library(parsnip)
library(recipes)
library(themis)
```

```{r Prepping data }

pmjdy <- read_dta("PMJDYmaster.dta")%>% 
  filter(!year == 2021) %>% # There is no pmjdy take up data for this year
  select(!partyinpower_dummy) # Unnecessary variable

# Editing latitude and longitude data due to Punjab, Chandigarh and Haryana having the same coordinates since they have the same capitals. 
pmjdy <- pmjdy %>%
  mutate(
    Latitude = case_when(
      Latitude == 18.9 ~ 19.8,
      Latitude == 17.5 ~ 15.9,
      TRUE ~ Latitude  
    ),
    Longitude = case_when(
      Longitude == 72.8 ~ 75.7, 
      Longitude == 78.6 ~ 79.7,
      TRUE ~ Longitude  
    )
  )

# Changing all variable names to lower case
names(pmjdy) <- tolower(names(pmjdy))

# Editing variables so that they can be used later in the geospatial analysis titles 
pmjdy = apply_labels(pmjdy, 
                     pmjdy = "PMJDY Uptake",
                     healthindex = "Health Index", 
                     incomeindex = "Income Index",
                     educationindex = "Education Index",
                     partyinpower = "Party in Power",
                     employment = "Employment",
                     pop = "Population"
                     )


```

```{r}

# Summary Statistics

# PMJDY 
n_pmjdy <- length(pmjdy$pmjdy)

mean_pmjdy <- mean(pmjdy$pmjdy, na.rm = TRUE)

sd_pmjdy <- sd(pmjdy$pmjdy, na.rm = TRUE)

min_pmjdy <- min(pmjdy$pmjdy, na.rm = TRUE)

max_pmjdy <- max(pmjdy$pmjdy, na.rm = TRUE)

# Inflation
n_inflation <- length(pmjdy$inflation)

mean_inflation <- mean(pmjdy$inflation, na.rm = TRUE)

sd_inflation <- sd(pmjdy$inflation, na.rm = TRUE)

min_inflation <- min(pmjdy$inflation, na.rm = TRUE)

max_inflation <- max(pmjdy$inflation, na.rm = TRUE)

# GDP 
n_gdp <- length(pmjdy$GDP)

mean_gdp <- mean(pmjdy$gdp, na.rm = TRUE)

sd_gdp <- sd(pmjdy$gdp, na.rm = TRUE)

min_gdp <- min(pmjdy$gdp, na.rm = TRUE)

max_gdp <- max(pmjdy$gdp, na.rm = TRUE)

# Health index
n_healthindex <- length(pmjdy$healthindex)

mean_healthindex <- mean(pmjdy$healthindex, na.rm = TRUE)

sd_healthindex <- sd(pmjdy$healthindex, na.rm = TRUE)

min_healthindex <- min(pmjdy$healthindex, na.rm =TRUE)

max_healthindex <- max(pmjdy$healthindex, na.rm = TRUE)

# Income index 
n_incomeindex <- length(pmjdy$incomeindex)

mean_incomeindex <- mean(pmjdy$incomeindex, na.rm = TRUE)

sd_incomeindex <- sd(pmjdy$incomeindex, na.rm = TRUE)

min_incomeindex <- min(pmjdy$incomeindex, na.rm =TRUE)

max_incomeindex <- max(pmjdy$incomeindex, na.rm = TRUE)

# Education index 
n_educationindex <- length(pmjdy$educationindex)

mean_eduationindex <- mean(pmjdy$educationindex, na.rm = TRUE)

sd_educationindex <- sd(pmjdy$educationindex, na.rm = TRUE)

min_educationindex <- min(pmjdy$educationindex, na.rm =TRUE)

max_educationindex <- max(pmjdy$educationindex, na.rm = TRUE)

# Employment
n_employment <- length(pmjdy$employment)

mean_employment <- mean(pmjdy$employment, na.rm = TRUE)

sd_employment <- sd(pmjdy$employment, na.rm = TRUE)

min_employment <- min(pmjdy$employment, na.rm =TRUE)

max_employment <- max(pmjdy$employment, na.rm = TRUE)

# Creating a table
column1 <- c("PMJDY", "Inflation", "GDP", "Health Index", "Income Index", "Education Index", "Employment")
column2 <- c(n_pmjdy, n_inflation, n_gdp, n_healthindex, n_incomeindex, n_educationindex, n_employment)
column3 <- c(mean_pmjdy, mean_inflation, mean_gdp, mean_healthindex, mean_incomeindex, mean_eduationindex, mean_employment)
column4 <- c(sd_pmjdy, sd_inflation, sd_gdp, sd_healthindex, sd_incomeindex, sd_educationindex, sd_employment)
column5 <- c(min_pmjdy, min_inflation, min_gdp, min_healthindex, min_incomeindex, min_educationindex, min_employment)
column6 <- c(max_pmjdy, max_inflation, max_gdp, max_healthindex, max_incomeindex, max_educationindex, max_employment)

column_names <- c("Variable", "Observations", "Mean", "Std. Dev.", "Min", "Max")

pmjdy_summarystats <- data.frame(Column1 = column1,
                                 Column2 = column2,
                                 Column3 = column3,
                                 Column4 = column4,
                                 Column5 = column5,
                                 Column6 = column6)

colnames(pmjdy_summarystats) <- column_names

print(pmjdy_summarystats)


```

## Interpretation

Based on the summary statistics we have generated, we can draw many insights. Some of the findings are:

-   **Average Take-up Rate (PMJDY):** The mean of 22.86 suggests a moderate level of bank account uptake under this scheme, with the minimum at 8.994 and the maximum at over 31, indicating significant variation among different states or over different years.

-   **Inflation:\
    \
    ** The mean inflation rate across the dataset is 4.77, with a standard deviation of around 2.02, pointing to varying economic conditions across the states. The minimum inflation rate is quite low at 0.5, suggesting a period or state with very stable prices, while the maximum is higher at around 7.6.

-   **GDP:**

    With a mean GDP of approximately 1.37e+05 and a broad range from 22201 to over 3.26e+05, this indicates a substantial disparity in the economic size and output among the states. The high standard deviation reflects this significant variation.

-   **Health, Income, and Education Indices:**

    The health, income, and education indices have means around 0.8, 0.65, and 0.59 respectively. All these indices exhibit relatively low variability (standard deviations around 0.06-0.07), suggesting somewhat uniform conditions across the dataset in terms of health access, income levels, and educational attainment. However, the ranges indicate some outliers or significant differences in some areas.

-   **Employment:**

    The employment rate has a mean of around 49, with a very high standard deviation of about 7.91, showing that employment rates vary widely across states. The range from 27.5 to 73 highlights some regions with relatively low employment rates and others with very high employment.\
    \
    These statistics provide the context in which the PMJDY scheme is being implemented. The variations in economic conditions, inflation, and human development indices suggest differing regional challenges and potentials for financial inclusion. The analysis of these variables can provide deeper insights into how regional disparities might be influencing the uptake of the PMJDY scheme, aiming to enhance financial inclusivity across various socio-economic backgrounds.
